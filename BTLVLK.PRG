Memvar getlist
Field Tglvlk,nota,Nama,Kodbrg,Kodelgn,tglabl,mukA,;
      mobil,qtt,harga,hari,mrk,pbr,ket
Function Btlvlk()
Local mno,mhari,br,mtot,hal,cin,jawab,jumlah,tglsls
 * PROGRAM PENERIMAAN BARANG
set color to
CLEAR
USE STK INDEX STKX.ELX NEW
USE TRVLK NEW
SET RELATION TO KODBRG INTO STK
BKVLK('BATAL BARANG KANISIRAN')
* --------- TAMPILAN LAYAR ------------------- *

DO WHILE .T.
SET COLOR TO W/N,W/N
@3,10 SAY 'K'
MNO:=0
@3,11 GET MNO PICT '@B 9999'
READ
IF MNO=0
  CLOSE ALL
  Return (nil)
ENDIF
DBGOTOP()
DO WHILE MNO<>NOTA .AND. .NOT. EOF()
   SKIP
ENDDO
IF MNO<>NOTA
   SET COLOR TO W/B
   @23,3 SAY ' NOMOR NOTA TIDAK DITEMUKAN, TEKAN SEMBARANG TOMBOL ...... '
   SET COLOR TO
   WAIT ''
   @23,3 CLEAR TO 23,63
   LOOP
ELSE
  EXIT
ENDIF
ENDDO
@4,10 SAY TGLVLK
@5,16 SAY MOBIL PICT '@!'

MHARI:=0
@3,49 SAY HARI PICT '99'
TGLSLS:=TGLVLK+HARI
@4,57 SAY TGLSLS

HAL:=1
BR:=9
MTOT:=0
CIN:=1

DO WHILE MNO=NOTA .AND. .NOT. EOF()
   SET COLOR TO W/N,W/N
   @BR,2 SAY HAL PICT '99'
   @BR,5 SAY KODBRG PICT '@!'
   @BR,16 SAY stk->NAMA
   @BR,37 SAY MRK
   @BR,41 SAY PBR
   @BR,45 SAY QTT PICT '999'
   @BR,49 SAY HARGA PICT '999,999'
   JUMLAH:=QTT*HARGA
   @BR,57 SAY JUMLAH PICT '99,999,999'
 IF KET<>'AFKIR '
   MTOT+=JUMLAH
 ENDIF
   @BR,68 SAY KET
IF BR=17
   SET COLOR TO W/B
   KOMENTAR(23,' GANTI HALAMAN BARU,TEKAN SEMBARANG TOMBOL ...... ')
  @9,0 CLEAR TO 23,70
  BR:=8
ENDIF
  SET COLOR TO
  @23,0
  HAL++
  BR++
SKIP
ENDDO
DBGOTOP()
 SET COLOR TO
  @23,0
SET COLOR TO W/N,W/N
 DO WHILE MNO<>NOTA
   SKIP
 ENDDO
@19,57 SAY MTOT PICT '999,999,999'
@20,57 SAY MUKA PICT '999,999,999'
@21,57 SAY MTOT-MUKA PICT '999,999,999'
JAWAB:=.N.
SET COLOR TO W/B,W+*/R
@23,3 SAY ' APAKAH DATA AKAN DIBATALKAN(Y/N) ? ' GET JAWAB PICT 'Y'
READ
  SET COLOR TO
  @23,0
IF  JAWAB
  SET COLOR TO W*/R
  @23,3 SAY ' TUNGGU PROSES .... '
  DO WHILE MNO=NOTA .AND. .NOT. EOF()
   DELETE
   SKIP
  ENDDO
  PACK
   SET COLOR TO W/B
  @23,3 SAY 'DATA SUDAH DI BATALKAN, TEKAN SEMBARANG TOMBOL ...... '
  SET COLOR TO
  WAIT ''
ELSE
  SET COLOR TO W/B
  @23,3 SAY 'DATA TIDAK DI BATALKAN, TEKAN SEMBARANG TOMBOL ...... '
  SET COLOR TO
  WAIT ''
ENDIF
CLOSE ALL
CLEAR
Return (nil)
