SET COLOR TO
 FOR I:=1 TO 25
     SCROLL(,,,,-1)
 NEXT
USE STK INDEX STKX.ELX NEW
USE LGN INDEX LGN.ELX NEW
USE TROUT INDEX TGLOUTX.ELX ALIAS KELUAR NEW

SET COLOR TO GR
@10,10 TO 13,62

DO WHILE .T.
SET COLOR TO GR+/B,W/R
MNOFAK:=0
MTGL=CTOD(' - - ')
@11,12 SAY ' MASUKAN FAKTUR YANG AKAN DICETAK : ' GET MNOFAK PICT '@B 99999'
@12,12 SAY ' MASUKAN TANGGAL FAKTUR           : ' GET MTGL PICT '@!'
READ
IF MNOFAK=0
  CLOSE ALL
  RETURN
ENDIF
SEEK MTGL
DO WHILE MNOFAK<>FAKTUR .AND. .NOT. EOF()
   SKIP
ENDDO
IF MNOFAK<>FAKTUR
  KOMENTAR(14,' DATA TIDAK DITEMUKAN, GANTI FAKTUR LAIN ..... ')
  @14,0
  LOOP
ELSE
  EXIT
ENDIF
ENDDO
SET RELATION TO KODBRG INTO STK,TO KODELGN INTO LGN
IF !CEKPRINT()
   CLOSE ALL
   return
ENDIF

LGJDLGB(0,1)
@2,2 SAY CHR(27)+CHR(52)+CHR(27)+CHR(15)+'SEDIA  '+;
         CHR(27)+CHR(53)+'SPOORING & BALANCING COMPUTER'+CHR(27)+CHR(18)
SDATE(2,40,MTGL)
@3,2 SAY CHR(27)+CHR(15)+'BAN LOCAL, IMPORT, VULKANISIR, VELG RACING '+;
         CHR(27)+CHR(18)
@3,40 SAY 'NO. FAKTUR    :'+TRAN(MNOFAK,'@B 99999')
@4,2 SAY CHR(27)+CHR(15)+'CUCI MOBIL, TUNE UP, VARIASI & GANTI OLI   '+;
         CHR(27)+CHR(18)
@4,40 SAY 'NAMA/NO MOBIL :'+PADR(LGN->NAMA,23)
@5,2 SAY CHR(27)+CHR(15)+'Jl. DR CIPTO NO. 5 Tlp. 431744, '+;
         'JL. BANCEUY NO. 117 TLP 4204321'+CHR(27)+CHR(18)

BR:=9;JUM:=0;TOT:=0;MTOT:=0;I:=11
@6,0 SAY REPLI('-',79)
@7,0 SAY '| NO | KODE BARANG |      NAMA BARANG       |  QTT  |   HARGA  |   JUMLAH     |'
@8,0 SAY REPLI('-',79)
NO:=0
DO WHILE ! EOF() .AND. MNOFAK=FAKTUR
   NO++
   @BR,0 SAY '|'+TRAN(NO,'@B 9999')+'|'+PADR(KODBRG,13)+'|';
             +(IF(KODBRG#'003       ',PADR(STK->NAMA,24),PADR(MOBIL,24)))+;
             '|'+TRAN(QTT,'@E 999,999')+'|'
   @BR,PCOL() SAY HARGA PICT '@E 99,999,999'+'|'
   TOT:=QTT*HARGA
   @BR,PCOL() SAY TOT PICT '@E 99,999,999,999'+'|'
   MTOT+=TOT
   MPOT:=MUKA
   I++
   BR++
   SKIP
ENDDO

@BR,0 SAY '|'
@BR,5 SAY '|'
@BR,19 SAY '|'
@BR,44 SAY '|'
@BR,52 SAY '|'
@BR,63 SAY '|'
@BR,64 SAY REPLI('-',14)
@BR,78 SAY '|'

BR++
@BR,0 SAY '|'
@BR,5 SAY '|'
@BR,19 SAY '|'
@BR,44 SAY '|'
@BR,52 SAY '|'
@BR,63 SAY '|'
@BR,64 SAY 'Rp.'
@BR,67 SAY MTOT PICT '@E 999,999,999'
@BR,78 SAY '|'

BR++
DO WHILE I<26
   @BR,0 SAY '|'
   @BR,5 SAY '|'
   @BR,19 SAY '|'
   @BR,44 SAY '|'
   @BR,52 SAY '|'
   @BR,63 SAY '|'
   @BR,78 SAY '|'
   BR++
   I++
ENDDO

@BR,0 SAY REPLI('-',79)
@BR+1,3 SAY ' HORMAT - KAMI '
@BR+1,53 SAY 'JUMLAH     Rp.'
@BR+1,67 SAY MTOT PICT '@E 999,999,999'
@BR+2,53 SAY 'PEMBAYARAN Rp.'
@BR+2,67 SAY MPOT PICT '@E 999,999,999'
@BR+3,53 SAY 'TOTAL      Rp.'
@BR+3,67 SAY MTOT-MPOT PICT '@E 999,999,999'
@br+4,0 say ''
@BR+5,0 SAY ''
@BR+6,0 SAY ''
@BR+7,0 SAY ''
SETPRC(0,0)
SET PRINT OFF
SET DEVICE TO SCREEN
SET COLOR TO
CLOSE ALL
RETURN
