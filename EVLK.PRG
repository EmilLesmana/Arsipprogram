Memvar getlist
Field Tglvlk,nota,Nama,Kodbrg,Kodelgn,tglabl,mukA,;
      mobil,qtt,harga,hari,mrk,pbr,ket
Function Evlk()
Local br,x,hal,mkodbrg,mtot,mhari,mmobil,mtgl,mno,tglsls,jumlah,mpot,mtglabl
 * PROGRAM PENERIMAAN BARANG
set color to
CLEAR
USE TRVLK NEW
USE NO NEW
USE STK INDEX STKX.ELX NEW
BKVLK('KOREKSI BARANG KANISIRAN')
* --------- TAMPILAN LAYAR ------------------- *

DO WHILE .T.
SET COLOR TO W/N,W/N
MNO:=0
@3,10 SAY 'K'
@3,11 GET MNO PICT '@B 9999'
READ
SELE TRVLK
DBGOTOP()
IF MNO=0
  CLOSE ALL
  Return (nil)
ENDIF
   DO WHILE MNO<>NOTA .AND. .NOT. EOF()
    SKIP
   ENDDO
   IF MNO<>NOTA
      KOMENTAR(23,' DATA TIDAK DITEMUKAN,TEKAN SEMBARANG TOMBOL ...... ')
      @23,0
      LOOP
   ELSE
      EXIT
   ENDIF
ENDDO
@4,10 GET TGLVLK
@5,16 GET MOBIL PICT '@!'
@3,49 GET HARI PICT '99'
READ
TGLSLS:=TGLVLK+HARI
@4,57 SAY TGLSLS
@5,57 GET TGLABL
READ
MTGL:=TGLVLK
MMOBIL:=MOBIL
MHARI:=HARI
MTGLABL:=TGLABL

HAL:=1
BR:=9
MTOT:=0

DO WHILE MNO=NOTA .AND. .NOT. EOF()
   SELE TRVLK
   MKODBRG=KODBRG
   SET COLOR TO W/N,W/N
   @BR,2 SAY HAL PICT '99'
   @BR,5 GET KODBRG PICT '@!'
   READ
   SELE STK
   SEEK TRVLK->KODBRG
   IF .NOT. FOUND()
      SET COLOR TO W/B
      @23,3 SAY ' KODE BARANG TIDAK DITEMUKAN,TEKAN SEMBARANG TOMBOL ...... '
      SET COLOR TO
      WAIT ''
      @23,3 CLEAR TO 23,63
      SELE TRVLK
      REPLACE KODBRG WITH MKODBRG
      LOOP
   ENDIF
   @BR,16 SAY STK->NAMA
   SELE TRVLK
   @BR,37 GET MRK PICT '@!'
   @BR,41 GET PBR PICT '@!'
   @BR,45 SAY QTT PICT '@Z 999'
   @BR,49 GET HARGA PICT '@Z 999,999'
   READ
   JUMLAH:=QTT*HARGA
   @BR,57 SAY JUMLAH PICT '99,999,999'
   MTOT:=MTOT+JUMLAH
   @BR,68 SAY KET
   REPLACE TGLVLK WITH MTGL,HARI WITH MHARI,MOBIL WITH MMOBIL

IF BR=17
   SET COLOR TO W/B
   KOMENTAR(23,' GANTI HALAMAN BARU,TEKAN SEMBARANG TOMBOL ...... ')
  @9,0 CLEAR TO 23,78
  BKVLK('KOREKSI BARANG KANISIRAN')
  BR:=8
ENDIF
 SET COLOR TO
  @23,0
  HAL++
  BR++
SKIP
ENDDO
 SET COLOR TO
  @23,2 CLEAR TO 23,63
SET COLOR TO W/N,W/N
@19,57 SAY MTOT PICT '99,999,999'
MPOT=0
 SELE TRVLK
 DBGOTOP()
 DO WHILE MNO<>NOTA
   SKIP
 ENDDO
 @20,57 GET MUKA PICT '@Z 99,999,999'
 READ
 MPOT:=MUKA
 DO WHILE MNO=NOTA
  REPLACE MUKA WITH MPOT
  SKIP
 ENDDO
@21,57 SAY MTOT-MPOT PICT '99,999,999'
   KOMENTAR(23,'TEKAN SEMBARANG TOMBOL, KEMBALI KE MENU ...... ')
 CLOSE ALL
 Return (nil)
