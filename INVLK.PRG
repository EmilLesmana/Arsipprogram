Memvar getlist
Field Nota,Kodbrg,Nama,Mobil,Hari,ket,harga,Mrk,pbr,qtt,tglabl,Muka,Nomor
Function Invlk()
LOCAL MCOLOR,I,MNO,MTGL,MMOBIL,MHARI,TGLSLS,HAL,BR,MTOT,MKODBRG,;
      MMRK,MPBR,MQTT,MHARGA,CIN:=1,ER,JUMLAH,JAWAB,JUDUL,msls,Tot,mPot,;
      Jum,mMuka
set color to
FOR I:=1 TO 25
    SCROLL(,,,,1)
NEXT

USE TRVLK NEW
USE NO NEW
USE STK INDEX ('STKX.ELX') NEW

BKVLK('PEMASUKAN BARANG KANISIR')

* --------- TAMPILAN LAYAR ------------------- *
SELE NO
SET COLOR TO W/N,W/N
MCOLOR:=SETCOLOR()
@3,10 SAY 'K'
@3,11 SAY NOMOR PICT '@B 9999'
MNO:=NOMOR
MTGL:=DATE()
@4,10 GET MTGL
READ

MMOBIL:=SPACE(20)
@5,16 GET MMOBIL PICT '@!'
READ

IF MMOBIL=''
  SET COLOR TO
  CLEAR
  CLOSE ALL
  Return (nil)
ENDIF

MHARI:=0
@3,49 GET MHARI PICT '99'
READ
TGLSLS:=MTGL+MHARI
@4,57 SAY TGLSLS

HAL:=1
BR:=9
MTOT:=0
MMRK:=SPACE(3)
MPBR:=SPACE(3)
MHARGA:=0

DO WHILE .T.
   MKODBRG:=SPACE(10)
   SELE STK
   SET COLOR TO W/N,W/N
   @BR,2 SAY HAL PICT '99'
   @BR,5 GET MKODBRG PICT '@!'
   READ
   IF MKODBRG=''
      ER:=.N.
      SET COLOR TO W/B
      @23,3 SAY ' APAKAH AKAN KEMBALI KE MENU[Y/N]?' GET ER PICT 'Y'
      READ
      IF .NOT. ER
         SET COLOR TO
         @23,3 CLEAR TO 23,63
         LOOP
      ELSE
         EXIT
      ENDIF
   ENDIF
   SEEK MKODBRG
   IF !FOUND()
      KOMENTAR(23,' KODE BARANG TIDAK DITEMUKAN .....')
      @23,0
      LOOP
   ENDIF
   @BR,16 SAY NAMA
   @BR,37 GET MMRK PICT '@!'
   @BR,41 GET MPBR PICT '@!'
   @BR,45 SAY '1'
   MQTT:=1
   @BR,49 GET MHARGA PICT '@Z 999,999'
   READ
   JUMLAH:=MQTT*MHARGA
   @BR,57 SAY JUMLAH PICT '99,999,999'
   MTOT+=JUMLAH
   @BR,68 SAY 'PROSES'
    SELE TRVLK
   APPEND BLANK
   REPLACE TGLVLK WITH MTGL,PBR WITH MPBR,HARI WITH MHARI,MOBIL WITH MMOBIL
   REPLACE NOTA WITH NO->NOMOR,KODBRG WITH MKODBRG
   REPLACE MRK WITH MMRK,QTT WITH MQTT,HARGA WITH MHARGA,KET WITH 'PROSES'
   CIN++

JAWAB:=.Y.
SET COLOR TO W/B,W+*/R
@23,3 SAY ' APAKAH ADA DATA LAGI(Y/N) ? ' GET JAWAB PICT 'Y'
READ

IF .NOT. JAWAB
   EXIT
ENDIF

IF BR=17
   KOMENTAR(23,' GANTI HALAMAN BARU,TEKAN SEMBARANG TOMBOL ...... ')
   @9,0 CLEAR TO 23,78
   BKVLK('PEMASUKAN BARANG KANISIR')
   BR:=8
ENDIF

SET COLOR TO
@23,0

HAL++
BR++
ENDDO
SETCOLOR(MCOLOR)
@19,57 SAY MTOT PICT '99,999,999'
MPOT:=0
IF CIN>1
   @20,57 GET MPOT PICT '99,999,999'
  READ
   REPLACE NO->NOMOR WITH NO->NOMOR+1
   IF NO->NOMOR=1001
      REPLACE NO->NOMOR WITH 1
   ENDIF
 SELE TRVLK
 DBGOTOP()
 DO WHILE MNO<>NOTA
    SKIP
 ENDDO
 DO WHILE MNO=NOTA
    REPLACE MUKA WITH MPOT
    SKIP
 ENDDO
ENDIF
@21,57 SAY MTOT-MPOT PICT '99,999,999'

IF CIN=1
   SET COLOR TO
   CLOSE ALL
   Return (nil)
ENDIF

JAWAB:=.N.
SET COLOR TO W/B,W*/R
@23,3 SAY ' APAKAH DATA AKAN DI CETAK (Y/N) ? ' GET JAWAB PICT 'Y'
READ
SET RELATION TO KODBRG INTO STK

IF .NOT. JAWAB
   SET COLOR TO
   CLEAR
   close all
   Return (nil)
ENDIF
  DBGOTOP()
 DO WHILE MNO<>NOTA
  SKIP
 ENDDO
    IF !CEKPRINT()
        CLOSE ALL
        Return (nil)
    ENDIF

@PROW(),PCOL() SAY CHR(27)+'@'
judul:=chr(76)+chr(65)+chr(74)+chr(85)+space(1)+chr(45)+space(1)+;
chr(74)+chr(65)+chr(89)+chr(65)
  @0,30 SAY judul
  ?? chr(15)
  @1,48 say 'Jl. MOH. TOHA 301 Tlp. (022)-504035     '
  @2,48 say 'Bandung FAX (022)-501941                '
  ?? chr(18)
  @3,1 SAY 'NO. NOTA :'
  @3,11 SAY 'K'
  @3,12 SAY MNO PICT '@B 9999'
  @3,40 SAY 'PROSES :['
  @3,49 say HARI pict '99'
  @3,51 say '] Hari'
  @4,1 SAY 'TANGGAL  :'
  SDATE(4,11,MTGL)
  MSLS=MTGL+HARI
  @4,40 SAY 'TANGGAL SELESAI :'
  @4,57 say MSLS
  @5,1 SAY 'NAMA/NO MOBIL :'
  @5,16 SAY MOBIL
  @5,40 SAY 'TANGGAL AMBIL   :'
  @5,57 SAY TGLABL

  BR:=9
  JUM:=0
  TOT:=0
  I:=11
  HAL:=1
@6,0 SAY REPLI('-',80)
@7,0 SAY '|NO| KODE BRG |   NAMA BARANG      |MRK|PBR|QTT| HARGA |    JUMLAH   |  KTRGN  |'
@8,0 SAY REPLI('-',80)
DO WHILE .NOT.EOF().AND.MNO=NOTA
@BR,0 SAY '|'+TRAN(HAL,'99')+'|'+KODBRG+'|'+STK->NAMA+'|'+MRK+'|'+PBR
@BR,PCOL() SAY '|'+TRAN(QTT,'999')+'|'+TRAN(HARGA,'999,999')+'|'
JUM:=QTT*HARGA
@BR,PCOL() SAY 'Rp.'+TRAN(JUM,'99,999,999')+'|'+PADR(KET,9)+'|'
I++;BR++;HAL++;TOT+=JUM
SKIP
ENDDO
@BR,0 SAY '|'
@BR,3 SAY '|'
@BR,14 SAY '|'
@BR,35 SAY '|'
@BR,39 SAY '|'
@BR,43 SAY '|'
@BR,47 SAY '|'
@BR,55 SAY '|'
@BR,56 SAY REPL('-',13)
@BR,69 SAY '|'
@BR,79 SAY '|'

BR++
@BR,0 SAY '|'
@BR,3 SAY '|'
@BR,14 SAY '|'
@BR,35 SAY '|'
@BR,39 SAY '|'
@BR,43 SAY '|'
@BR,47 SAY '|'
@BR,55 SAY '|'
@BR,56 SAY 'Rp.'
@BR,59 SAY TOT PICT '99,999,999'
@BR,69 SAY '|'
@BR,79 SAY '|'

BR++
DO WHILE I<26
@BR,0 SAY '|'
@BR,3 SAY '|'
@BR,14 SAY '|'
@BR,35 SAY '|'
@BR,39 SAY '|'
@BR,43 SAY '|'
@BR,47 SAY '|'
@BR,55 SAY '|'
@BR,69 SAY '|'
@BR,79 SAY '|'
MMUKA=MUKA
BR++;I++
ENDDO
@BR,0 SAY REPLI('-',80)
@BR+1,49 SAY 'JUMLAH Rp.'
@BR+1,59 SAY TOT PICT '99,999,=99'
@BR+2,46 SAY 'UANG MUKA Rp.'
@BR+2,59 SAY MPOT PICT '99,999,999'
@BR+3,49 SAY 'SISA   Rp.'
@BR+3,59 SAY TOT-MPOT PICT '99,999,999'
@BR+4,0 SAY ''
@BR+5,0 SAY ''
@BR+6,0 SAY ''
@BR+7,0 SAY ''
?? CHR(18)
SETPRC(0,0)
SET PRINT OFF
SET DEVICE TO SCREEN
SET COLOR TO
CLOSE ALL
CLEAR
Return (nil)